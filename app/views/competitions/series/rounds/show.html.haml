= render 'competitions/header', competition: @competition, sub: 'Serien', resource_class: Series::Round

.row.g-4
  .col-md-6
    = card(@round.name) do |card|
      - card.direct do
        %table.table
          %thead
            %tr
              %th Ort
              %th Datum
          %tbody
            - @round.cups.each do |cup|
              %tr
                %td= cup.competition_place
                %td= cup.competition_date
  - if @person_assessments.present?
    .col-md-6
      = card('Einzelwertungen') do |card|
        - card.direct do
          %table.table
            %thead
              %tr
                %th Disziplin
                %th Wettk√§mpfer
                %th
            %tbody
              - @person_assessments.each do |row|
                %tr
                  %td
                    = discipline_image(row.discipline.key)
                    = row.name
                %td= row.participations.pluck(:person_id).uniq.count
                %td= link_to('Ansehen', controller: 'series/assessments', action: :show, id: row)

- if @team_assessments_exists
  - %i[female male].each do |gender|
    - next if @round.team_assessment_rows(@competition, gender).blank?

    = card("Mannschaftswertung #{t("gender.#{gender}")}") do |card|
      - card.direct do
        %table.table
          %th Platz
          %th Team
          - @round.cups.each do |cup|
            %th= cup.competition_place
          %th Teil.
          %th Bestzeit
          %th Punkte
          - @round.team_assessment_rows(@competition, gender).each do |row|
            %tr
              %td= row.rank
              %td= row.name_with_number
              - @round.cups.each do |cup|
                %td= render('competitions/series/rounds/participations_table', participations: row.participations_for_cup(cup))
              %td= row.count
              %td= row.best_result_entry
              %td= row.points
